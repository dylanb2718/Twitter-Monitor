(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14228,        348]
NotebookOptionsPosition[     11518,        293]
NotebookOutlinePosition[     11904,        310]
CellTagsIndexPosition[     11861,        307]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Deployment Process", "Section",ExpressionUUID->"cc048347-7bdc-4c3e-a84d-9e92f9ee8cb8"],

Cell[CellGroupData[{

Cell["1. Create Databin", "Subsection",ExpressionUUID->"c73da20d-36fe-4caa-acf4-0e63d25b795e"],

Cell["\<\
Creating the Databin is the first step because the Short ID is needed for the \
ProcessorTask as well as the graphics.\
\>", "Text",ExpressionUUID->"02101a3b-6d2f-4919-a10f-2697ea859ed7"],

Cell[BoxData[
 RowBox[{"CreateDatabin", "[", 
  RowBox[{"<|", 
   RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<TwitterSilo\>\""}], "|>"}], 
  "]"}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"f4d4461a-90d1-477b-b56e-fbe4af3e46f7"],

Cell["\<\
Once the Databin has been created, modify ProcessorCode.wl, PieCharts.wl, \
SentimentHistogram.wl, and SentimentListPlot.wl to use the correct Short ID.\
\>", "Text",ExpressionUUID->"596e6792-5cc5-4a29-a6d1-f45ea1ed1317"]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Upload Packages to System Directory", "Subsection",ExpressionUUID->"9c08469f-702c-4d13-b7a2-e915adab6e74"],

Cell["\<\
All the packages that are required for this system to work need to be \
uploaded to the cloud in order for the system to work. The code below will \
quickly copy all of the local files to a folder on the cloud called \
\[OpenCurlyDoubleQuote]TwitterAnalysis\[CloseCurlyDoubleQuote] since that is \
what I defined the directory to be in the packages. You are welcome to change \
this, just make sure that the correct directory appears in all the packages.\
\>", "Text",ExpressionUUID->"8b0e8466-9710-4876-bda7-26a99687bd12"],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"CopyFile", "[", 
     RowBox[{"#", ",", 
      RowBox[{"CloudObject", "[", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "\[Rule]", 
          "\"\<TwitterAnalysis/\>\""}]}], "]"}], "]"}]}], "]"}], "&"}], ",", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.wl\>\"", ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Packages\>\""}], 
       "}"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}]], "Input",ExpressionUUI\
D->"3c2cfd93-1821-415e-907d-39c00a71f57c"]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Deploy Twitter Tokens", "Subsection",ExpressionUUID->"806205cf-e855-49f0-b8ba-d1907831339a"],

Cell["\<\
The whole system is built around calling the Twitter search API. To do this, \
you need to have developer tokens for Twitter that are accessible by your \
ReaperTask. The location of the tokens is specified in ReaperCode.wl, but can \
be anywhere on the cloud as long as the paths are correct. To deploy tokens \
to the default location, evaluate the following:\
\>", "Text",ExpressionUUID->"2f2e2db3-319f-46f8-9a25-aea2c9ccb173"],

Cell[BoxData[
 RowBox[{"CloudPut", "[", 
  RowBox[{
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<ConsumerKey\>\"", "\[Rule]", "\"\<XXXX\>\""}], ",", 
     RowBox[{"\"\<ConsumerSecret\>\"", "\[Rule]", "\"\<XXXX\>\""}], ",", 
     RowBox[{"\"\<OAuthToken\>\"", "\[Rule]", "\"\<XXXX\>\""}], ",", 
     RowBox[{"\"\<OAuthTokenSecret\>\"", "\[Rule]", "\"\<XXXX\>\""}]}], 
    "|>"}], ",", "\"\<TwitterAnalysis/AccessTokens.wl\>\""}], "]"}]], "Input",\
ExpressionUUID->"2bfc648c-6009-4687-97ec-7460e74f090b"],

Cell[TextData[{
 "Note: you need to replace \[OpenCurlyDoubleQuote]XXXX\
\[CloseCurlyDoubleQuote] with ",
 StyleBox["your",
  FontSlant->"Italic"],
 " tokens."
}], "Text",ExpressionUUID->"4a376d35-2772-4c04-a0e7-1284a606ff24"]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Deploy ReaperTask", "Subsection",ExpressionUUID->"13a1a47e-26ee-4d42-8087-4121ce2b7fe8"],

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", "\n", "\t", 
  RowBox[{
   RowBox[{"ScheduledTask", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
     "Get", "[", "\"\<TwitterAnalysis/Packages/Tasks/ReaperCode.wl\>\"", 
      "]"}], ",", "\n", "\t\t", "\"\<Hourly\>\"", ",", "\n", "\t\t", 
     RowBox[{"NotificationFunction", "\[Rule]", "None"}]}], "\n", "\t", "]"}],
    ",", "\n", "\t", "\"\<TwitterAnalysis/Tasks/reaper.task\>\""}], "\n", 
  "]"}]], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"8d39505a-91e2-423f-b9eb-82e2f24635f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["5. Deploy ProcessorTask", "Subsection",ExpressionUUID->"11837b66-c054-45c2-af72-48953d18cf28"],

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", "\n", "\t", 
  RowBox[{
   RowBox[{"ScheduledTask", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
     "Get", "[", "\"\<TwitterAnalysis/Packages/Tasks/ProcessorCode.wl\>\"", 
      "]"}], ",", "\n", "\t\t", "\"\<Hourly\>\"", ",", "\n", "\t\t", 
     RowBox[{"NotificationFunction", "\[Rule]", "None"}]}], "\n", "\t", "]"}],
    ",", "\n", "\t", "\"\<TwitterAnalysis/Tasks/processor.task\>\""}], "\n", 
  "]"}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"1410d027-e0ae-47d1-8109-e1b44bd1f540"]
}, Closed]],

Cell[CellGroupData[{

Cell["6. Deploy Graphics", "Subsection",ExpressionUUID->"d6c06c9d-22d8-44a5-9be1-be77af641279"],

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"AutoRefreshed", "[", 
    RowBox[{
     RowBox[{"Get", "[", 
      RowBox[{
      "CloudObject", "[", 
       "\"\<TwitterAnalysis/Packages/Graphics/SentimentHistogram.wl\>\"", 
       "]"}], "]"}], ",", "\"\<Hourly\>\"", ",", "\"\<PNG\>\""}], "]"}], ",", 
   "\"\<TwitterAnalysis/Graphics/SentimentHistogram\>\""}], "]"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"435f5e27-4238-46ff-a685-4c632ae8805f"],

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"AutoRefreshed", "[", 
    RowBox[{
     RowBox[{"Get", "[", 
      RowBox[{
      "CloudObject", "[", 
       "\"\<TwitterAnalysis/Packages/Graphics/SentimentListPlot.wl\>\"", 
       "]"}], "]"}], ",", "\"\<Hourly\>\"", ",", "\"\<PNG\>\""}], "]"}], ",", 
   "\"\<TwitterAnalysis/Graphics/SentimentListPlot\>\""}], "]"}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"1d5601d6-83ae-4140-8f57-32d8d4e4fcab"],

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"AutoRefreshed", "[", 
    RowBox[{
     RowBox[{"Get", "[", 
      RowBox[{
      "CloudObject", "[", 
       "\"\<TwitterAnalysis/Packages/Graphics/PieCharts.wl\>\"", "]"}], "]"}],
      ",", "\"\<Hourly\>\"", ",", "\"\<PNG\>\""}], "]"}], ",", 
   "\"\<TwitterAnalysis/Graphics/PieCharts\>\""}], "]"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"564796b9-93dc-4ee7-9910-922dc1d8acb8"]
}, Closed]],

Cell[CellGroupData[{

Cell["7. Deploy Dashboard", "Subsection",ExpressionUUID->"36fcd48b-acde-4e29-bff2-598ddc51cbc7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Delayed", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Get", "[", 
      RowBox[{
      "CloudObject", "[", 
       "\"\<TwitterAnalysis/Utilities/TwitterStyling.wl\>\"", "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Notebook", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cell", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BoxData", "[", "\[IndentingNewLine]", 
            RowBox[{"ToBoxes", "[", "\[IndentingNewLine]", 
             RowBox[{"ImageCrop", "[", "\[IndentingNewLine]", 
              RowBox[{"ImportString", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"URLRead", "[", 
                 RowBox[{
                  RowBox[{
                  "CloudObject", "[", 
                   "\"\<TwitterAnalysis/Graphics/SentimentHistogram\>\"", 
                   "]"}], ",", "\"\<Body\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", "\"\<PNG\>\""}], "\[IndentingNewLine]",
                "]"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
             "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\"\<Output\>\""}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Cell", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BoxData", "[", "\[IndentingNewLine]", 
            RowBox[{"ToBoxes", "[", "\[IndentingNewLine]", 
             RowBox[{"ImageCrop", "[", "\[IndentingNewLine]", 
              RowBox[{"ImportString", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"URLRead", "[", 
                 RowBox[{
                  RowBox[{
                  "CloudObject", "[", 
                   "\"\<TwitterAnalysis/Graphics/SentimentListPlot\>\"", 
                   "]"}], ",", "\"\<Body\>\""}], "]"}], ",", 
                "\[IndentingNewLine]", "\"\<PNG\>\""}], "\[IndentingNewLine]",
                "]"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
             "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\"\<Output\>\""}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Cell", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BoxData", "[", "\[IndentingNewLine]", 
            RowBox[{"ToBoxes", "[", "\[IndentingNewLine]", 
             RowBox[{"ImageCrop", "[", "\[IndentingNewLine]", 
              RowBox[{"ImportString", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"URLRead", "[", 
                 RowBox[{
                  RowBox[{
                  "CloudObject", "[", 
                   "\"\<TwitterAnalysis/Graphics/PieCharts\>\"", "]"}], ",", 
                  "\"\<Body\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                "\"\<PNG\>\""}], "\[IndentingNewLine]", "]"}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\"\<Output\>\""}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"BackgroundColor", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "\"\<TwitterAnalysis/Dashboard.nb\>\""}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"7c53e8f1-177c-4e6b-b4c8-aa3faae5134d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"CloudObject", "[", 
   TemplateBox[{
    "\"https://www.wolframcloud.com/objects/dylanb/TwitterAnalysis/Dashboard.\
nb\"","https://www.wolframcloud.com/objects/dylanb/TwitterAnalysis/Dashboard.\
nb"},
    "HyperlinkURL"], "]"}],
  CloudObject[
  "https://www.wolframcloud.com/objects/dylanb/TwitterAnalysis/Dashboard.nb"],
  
  SelectWithContents->True]], "Output",
 CellLabel->"Out[34]=",ExpressionUUID->"43ccef46-fa34-4a69-a4fa-007e9fd2d802"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{958, 1027},
WindowMargins->{{1, Automatic}, {1, Automatic}},
WindowStatusArea->None,
TrackCellChangeTimes->False,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 7, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 92, 0, 68, "Section",ExpressionUUID->"cc048347-7bdc-4c3e-a84d-9e92f9ee8cb8"],
Cell[CellGroupData[{
Cell[697, 26, 94, 0, 55, "Subsection",ExpressionUUID->"c73da20d-36fe-4caa-acf4-0e63d25b795e"],
Cell[794, 28, 197, 3, 35, "Text",ExpressionUUID->"02101a3b-6d2f-4919-a10f-2697ea859ed7"],
Cell[994, 33, 232, 5, 31, "Input",ExpressionUUID->"f4d4461a-90d1-477b-b56e-fbe4af3e46f7"],
Cell[1229, 40, 231, 3, 58, "Text",ExpressionUUID->"596e6792-5cc5-4a29-a6d1-f45ea1ed1317"]
}, Closed]],
Cell[CellGroupData[{
Cell[1497, 48, 115, 0, 39, "Subsection",ExpressionUUID->"9c08469f-702c-4d13-b7a2-e915adab6e74"],
Cell[1615, 50, 533, 7, 104, "Text",ExpressionUUID->"8b0e8466-9710-4876-bda7-26a99687bd12"],
Cell[2151, 59, 706, 19, 55, "Input",ExpressionUUID->"3c2cfd93-1821-415e-907d-39c00a71f57c"]
}, Closed]],
Cell[CellGroupData[{
Cell[2894, 83, 101, 0, 39, "Subsection",ExpressionUUID->"806205cf-e855-49f0-b8ba-d1907831339a"],
Cell[2998, 85, 440, 6, 81, "Text",ExpressionUUID->"2f2e2db3-319f-46f8-9a25-aea2c9ccb173"],
Cell[3441, 93, 506, 10, 55, "Input",ExpressionUUID->"2bfc648c-6009-4687-97ec-7460e74f090b"],
Cell[3950, 105, 226, 6, 35, "Text",ExpressionUUID->"4a376d35-2772-4c04-a0e7-1284a606ff24"]
}, Closed]],
Cell[CellGroupData[{
Cell[4213, 116, 97, 0, 39, "Subsection",ExpressionUUID->"13a1a47e-26ee-4d42-8087-4121ce2b7fe8"],
Cell[4313, 118, 537, 11, 193, "Input",ExpressionUUID->"8d39505a-91e2-423f-b9eb-82e2f24635f6"]
}, Closed]],
Cell[CellGroupData[{
Cell[4887, 134, 100, 0, 39, "Subsection",ExpressionUUID->"11837b66-c054-45c2-af72-48953d18cf28"],
Cell[4990, 136, 543, 11, 193, "Input",ExpressionUUID->"1410d027-e0ae-47d1-8109-e1b44bd1f540"]
}, Closed]],
Cell[CellGroupData[{
Cell[5570, 152, 95, 0, 39, "Subsection",ExpressionUUID->"d6c06c9d-22d8-44a5-9be1-be77af641279"],
Cell[5668, 154, 479, 11, 78, "Input",ExpressionUUID->"435f5e27-4238-46ff-a685-4c632ae8805f"],
Cell[6150, 167, 477, 11, 78, "Input",ExpressionUUID->"1d5601d6-83ae-4140-8f57-32d8d4e4fcab"],
Cell[6630, 180, 459, 11, 55, "Input",ExpressionUUID->"564796b9-93dc-4ee7-9910-922dc1d8acb8"]
}, Closed]],
Cell[CellGroupData[{
Cell[7126, 196, 96, 0, 39, "Subsection",ExpressionUUID->"36fcd48b-acde-4e29-bff2-598ddc51cbc7"],
Cell[CellGroupData[{
Cell[7247, 200, 3739, 74, 1159, "Input",ExpressionUUID->"7c53e8f1-177c-4e6b-b4c8-aa3faae5134d"],
Cell[10989, 276, 489, 12, 71, "Output",ExpressionUUID->"43ccef46-fa34-4a69-a4fa-007e9fd2d802"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

